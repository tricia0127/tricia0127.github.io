<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>python实现基于哈夫曼算法的加解密工具 | SERENDIPITY</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="SERENDIPITY">
    <meta name="author" content="Tricia">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="SERENDIPITY" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/code/" class="animsition-link">Code<small>(3)</small></a></li>
				    
				    <li><a href="/categories/daily-life/" class="animsition-link">Daily Life<small>(4)</small></a></li>
				    
				    <li><a href="/categories/design/" class="animsition-link">Design<small>(2)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://attanwu.com/" class="animsition-link">Attan</a></li>
                    
                    <li><a href="http://www.czxyl.me/" class="animsition-link">czxyl</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">SERENDIPITY</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/tricia0127" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            
                            
                            
                            <li><a href="http://weibo.com/919970127" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2017-11-16T15:49:13.000Z" itemprop="datePublished">
          2017-11-16
      </time>
    
    
    | 
    <a href='/tags/python/'>Python</a>
    
    
</span>
                <h1>python实现基于哈夫曼算法的加解密工具</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h2 id="1-写在开头"><a href="#1-写在开头" class="headerlink" title="1.写在开头"></a>1.写在开头</h2><p>本学期程序设计周的题目，利用哈夫曼算法实现了一个加解密的工具。</p>
<p>基本要求：<br>(1) 根据给定的单词字典库，为每个单词配置一个随机数作为权重，利用哈夫曼算法为各单词生成对应的密文，从而构造密码字典；<br>(2) 利用密码字典实现对输入文件的加解密；<br>(3) 界面友好、直观；<br>提高要求：<br>(1)    按照基本要求实现的加解密系统无法抵抗基于单词频度分析的攻击，试设计能够抵御频度分析攻击的基于哈夫曼算法的加解密方法（提示：可以采用多密码字典混合加解密的方法，加密时随机选择某一个密码字典）；<br>(2)    当密码字典规模较大时，加解密的性能必然受到影响，试设计好的算法提高加解密的效率。<br>课题理解：<br>一般哈夫曼算法多用于文件、图片的解压缩，但此题目主要是希望我们做一个利用哈夫曼算法做一个加解密的工具。通过构造哈夫曼树，我们可以获得各个英文单词所对应的编码。需要的功能有：从文件导入明文，随机选择一个密码字典对其加密并生成密文，将密文保存到文件。<br>在编写各项功能前，需要自己收集单词字典素材，我选择通过去维基百科找一篇文章，利用正则匹配的方法将所有英文单词匹配下来，再进行去重的方法做了一个密码字典，其中包含了上千个不重复的英文单词。<br>另外需要注意的是，为了保证加密程序的安全性和可靠性，只采用一个字典库是不够的，为了抵御频度攻击，在后期的设计上，应考虑采用多密码字典混合加解密的方法对明密文处理，以获得一个性能优良、安全性高的加解密工具。<br>此程序需要有gui的界面，以达到用户友好地交互功能。<br><br></p>
<h2 id="2-数据结构说明"><a href="#2-数据结构说明" class="headerlink" title="2.数据结构说明"></a>2.数据结构说明</h2><p><img src="https://s2.ax1x.com/2019/11/15/MawaLj.png" alt="image"><br>这里简单罗列了几种程序中用到的数据结构形式。<br>在正则匹配单词生成字典并给单词随机赋权值的时候，单词库是以python中“字典”的数据结构进行存储的。这种数据结构的独特之处在于：字典是一种可变容器模型，且可存储任意类型对象。字典的每个键值(key=&gt;value)对用冒号(:)分割，每个对之间用逗号(,)分割，整个字典包括在花括号({})中 ,格式如下所示：<br>d = {key1 : value1, key2 : value2 }<br><br><br></p>
<h2 id="3-算法设计"><a href="#3-算法设计" class="headerlink" title="3.算法设计"></a>3.算法设计</h2><p>程序导入了三个模块，分别为<br>HuffmanTree.py，NodeDataIO.py，decode.py。<br>以下对各模块做具体分析。 <br>   </p>
<h3 id="3-1HuffmanTree-py模块"><a href="#3-1HuffmanTree-py模块" class="headerlink" title="3.1HuffmanTree.py模块"></a>3.1HuffmanTree.py模块</h3><p><img src="https://s2.ax1x.com/2019/11/15/MawglF.png" alt="image"><br></p>
<h4 id="3-1-1-class-TreeNode"><a href="#3-1-1-class-TreeNode" class="headerlink" title="3.1.1 class TreeNode"></a>3.1.1 class TreeNode</h4><p>用于存储哈夫曼树的节点结构。存储了左孩子、右孩子、字符、权值、编码、父节点等属性。<br></p>
<h4 id="3-1-2-class-HuffmanTree"><a href="#3-1-2-class-HuffmanTree" class="headerlink" title="3.1.2 class HuffmanTree"></a>3.1.2 class HuffmanTree</h4><p>主要功能是构造哈夫曼树，算上类的构造函数<strong>init</strong>，一共有12个方法。<br><strong>nodesToObject(self, nodeList)：将字符和对应权值以python的列表结构存储。    
</strong>createTree(self, nodeList)：用给定的节点列表nodeList 创建哈夫曼树，返回根节点。<br>display(self, root)：打开tree.txt文档，为存储哈夫曼树做准备。<br><strong>display(self, root, level = ‘’)：使用缩进格式在文件中输出哈夫曼树。  
</strong>encode(self, root)：给每个树节点相应的编码值。<br>getTree(self)：获取以nodeList为节点的哈夫曼树。<br>findNode(self, root, value)：获取值为value的节点。<br>__goForAncesstor(self, node, encoding)：从叶子结点node开始，回到根节点，同时获取该节点的哈夫曼编码。<br>getCharEncoding(self, value)：获取字符value的哈夫曼编码。<br>getCharDecoding(self, encoding)：获取编码为encoding的字符。<br>reachAllLeafs(self, root)：遍历每个叶子，将每个字符的编码存入字典encodingList。  <br></p>
<h4 id="3-1-3-class-Encoding"><a href="#3-1-3-class-Encoding" class="headerlink" title="3.1.3 class Encoding"></a>3.1.3 class Encoding</h4><p>不包括类的构造函数，有以下三个方法：<br>getStringEncoding(self, string)：字符串加密，将明文中的单词与字典encodingList中的单词匹配，然后存入encoding作为密文。<br>getStringDecoding(self, encoding)：字符串解密，将密文编码与字典encodingList中的单词对应的编码匹配，转换成明文单词，然后存入字符串string。<br>compare(obj)：设置类TreeNode的比较器。  <br></p>
<h3 id="3-2-NodeDataIO-py模块"><a href="#3-2-NodeDataIO-py模块" class="headerlink" title="3.2 NodeDataIO.py模块"></a>3.2 NodeDataIO.py模块</h3><p><img src="https://s2.ax1x.com/2019/11/15/MawhwR.png" alt="image"><br><br>此模块的主要功能是节点信息的读取和存储。<br>class NodeDataIO类的初始化方法里实现的功能是在password dictionary文件夹中随机选择一个密码字典，是为“加密”功能服务的。属性中的fileName1就是随机选择的字典的文件名。<br>__readNextNode(self)：从文件中读取下一个结点的信息。<br>getNodes(self)：返回文件中所有节点信息构成的列表。<br>SaveNode(self, nodes)：将所有节点信息构成的列表存入文件。  <br></p>
<h3 id="3-3-decode-py模块"><a href="#3-3-decode-py模块" class="headerlink" title="3.3 decode.py模块"></a>3.3 decode.py模块</h3><p><img src="https://s2.ax1x.com/2019/11/15/MawcSU.png" alt="image"><br><br>decode.py模块仅仅服务于解密，除了类的初始化方法，其余方法都和NodeDataIO.py模块中的相同。为了在多密码字典加密情况下解密可以一次性找到当时加密的字典，所以要通过该模块的初始化方法中获取到加密时密码字典的文件名。<br></p>
<h3 id="3-4-Dialog-pyw主要执行过程"><a href="#3-4-Dialog-pyw主要执行过程" class="headerlink" title="3.4 Dialog.pyw主要执行过程"></a>3.4 Dialog.pyw主要执行过程</h3><p><img src="https://s2.ax1x.com/2019/11/15/MawsYV.png" alt="image"><br><br></p>
<h2 id="4-详细设计"><a href="#4-详细设计" class="headerlink" title="4.详细设计"></a>4.详细设计</h2><h3 id="4-1-Dialog-pyw核心代码"><a href="#4-1-Dialog-pyw核心代码" class="headerlink" title="4.1 Dialog.pyw核心代码"></a>4.1 Dialog.pyw核心代码</h3><p>dictionary函数用于造单词字典，采用的方法是正则匹配英文文章中的每个英文单词，去重、排序后赋值，值为随机且不重复的2000以内的数值，给密码字典随机命名为 dictionary + random随机值 .txt的形式，为解密选择字典编号服务。</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">def dictionary(self): </div><div class="line">   f = open(<span class="string">"/Users/zhangchuyue/Desktop/分词+随机权重程序/test.txt"</span>) </div><div class="line">   <span class="keyword">try</span>: </div><div class="line">        <span class="built_in">text</span> = f.<span class="built_in">read</span>()  <span class="comment"># 读取整个文件并放入一个字符串变量中 </span></div><div class="line">        <span class="built_in">words</span> = re.findall(r<span class="string">"\b[a-zA-Z]&#123;1,50&#125;\b"</span>, <span class="built_in">text</span>)  <span class="comment"># 正则匹配所有英文单词得到一个列表 </span></div><div class="line">        results = [] </div><div class="line">        dictionary = &#123;&#125; </div><div class="line">        value = <span class="number">0</span> </div><div class="line">        li = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2000</span>)] </div><div class="line">        li1 = random.sample(li, <span class="number">2000</span>) </div><div class="line">        <span class="keyword">for</span> <span class="built_in">word</span> <span class="keyword">in</span> <span class="built_in">words</span>: </div><div class="line">            <span class="literal">result</span> = <span class="built_in">word</span>.lower()  <span class="comment"># 将英文单词全部转为小写 </span></div><div class="line">            results.append(<span class="literal">result</span>) </div><div class="line">        results = <span class="built_in">list</span>(<span class="keyword">set</span>(results))  <span class="comment"># 将匹配结果存储在列表里并用set函数去除重复单词 </span></div><div class="line">        results.sort()  <span class="comment"># 对列表排序 </span></div><div class="line">        <span class="keyword">for</span> <span class="literal">result</span> <span class="keyword">in</span> results: </div><div class="line">            dictionary[<span class="literal">result</span>] = li1[value]     <span class="comment"># 单词为字典的键，随机数为值，作为每个单词的权重 </span></div><div class="line">            value += <span class="number">1</span> </div><div class="line">        <span class="built_in">number</span> = random.randint(<span class="number">100</span>, <span class="number">999</span>) </div><div class="line">        output = open(<span class="string">"/Users/zhangchuyue/Desktop/B15040805张楚月_哈夫曼加解密工具/password dictionary/dictionary%d.txt"</span> % <span class="built_in">number</span>, <span class="string">"w"</span>)  </div><div class="line">        print(dictionary) </div><div class="line">        print(<span class="string">"create password dictionary："</span> + <span class="string">"dictionary%d.txt"</span> % <span class="built_in">number</span>) </div><div class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> dictionary: </div><div class="line">            output.writelines(key + <span class="string">":"</span> + str(dictionary[key]) + <span class="string">"\n"</span>)     <span class="comment"># 字典内容写入文件 </span></div><div class="line">        output.close() </div><div class="line">   finally: </div><div class="line">        f.close()</div></pre></td></tr></table></figure>
<p>实例化类NodeDataIO()和HuffmanTree，获得实例对象，用于输出哈夫曼树tree.txt。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printTree</span><span class="params">(<span class="keyword">self</span>)</span></span>: </div><div class="line">    io = NodeDataIO() </div><div class="line">    nodeList = io.getNodes() </div><div class="line">    tree = HuffumanTree(nodeList) </div><div class="line">    tree.display(tree.getTree()) </div><div class="line">    os.system(<span class="string">'notepad tree.txt'</span>) </div><div class="line">    <span class="keyword">return</span> io</div></pre></td></tr></table></figure>
<p>def transform(self)用于字符转化为编码形式，实例化类NodeDataIO()和HuffmanTree，获得实例对象，首先在NodeDataIO类中初始化方法随机选择出一个密码字典，然后通过NodeDataIO类中的函数获得节点列表，再调用HuffmanTree类中的函数构造字符和编码的字典，调用HuffmanTree类中的编码函数getStringEncoding(text)进行编码。此函数中的count = io.fileName1[10:13]得到的是所选用的字典文件名的字典编号，用于存储到密文开头，为解密服务。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(<span class="keyword">self</span>)</span></span>: </div><div class="line">io = NodeDataIO()     <span class="comment"># 实例化对象</span></div><div class="line">    nodeList = io.getNodes() </div><div class="line">    tree = HuffumanTree(nodeList) </div><div class="line">    encoder = Encoding(tree.encodingList) </div><div class="line">    count = io.fileName1[<span class="number">10</span><span class="symbol">:</span><span class="number">13</span>]      <span class="comment"># 将密码字典文件名中的随机三位数编号赋值给count</span></div><div class="line">    <span class="keyword">self</span>.count = count </div><div class="line">    <span class="keyword">if</span>(<span class="keyword">self</span>.encoding[<span class="string">'state'</span>] != <span class="string">'disabled'</span>)<span class="keyword">and</span>(<span class="keyword">self</span>.string[<span class="string">'state'</span>] != <span class="string">'disabled'</span>): </div><div class="line">            <span class="keyword">return</span> </div><div class="line">    elif(<span class="keyword">self</span>.encoding[<span class="string">'state'</span>] == <span class="string">'disabled'</span>)<span class="keyword">and</span>(<span class="keyword">self</span>.string[<span class="string">'state'</span>] != <span class="string">'disabled'</span>): </div><div class="line">        text = <span class="keyword">self</span>.string.get(<span class="string">'0.0'</span>, <span class="keyword">END</span>).strip(<span class="string">'\n'</span>) </div><div class="line">        <span class="symbol">try:</span> </div><div class="line">            encoding = bin(int(io.fileName1[<span class="number">10</span><span class="symbol">:</span><span class="number">13</span>]))[<span class="number">2</span><span class="symbol">:</span>] + encoder.getStringEncoding(text)   <span class="comment">#编码为开头以二进制形式呈现的字典标号和密文字符串</span></div><div class="line">        <span class="symbol">except:</span> </div><div class="line">            tkinter.messagebox.showerror(<span class="string">'错误'</span>, <span class="string">'您输入的文本中包含未编码的字符，请重新输入！'</span>) </div><div class="line">            <span class="keyword">return</span> </div><div class="line">        <span class="keyword">self</span>.encoding[<span class="string">'state'</span>] = <span class="string">'normal'</span> </div><div class="line">        <span class="keyword">self</span>.encoding.delete(<span class="string">'0.0'</span>, <span class="keyword">END</span>) </div><div class="line">        <span class="keyword">self</span>.encoding.insert(<span class="string">'0.0'</span>, encoding) </div><div class="line">        <span class="keyword">self</span>.__reset.focus_set()</div></pre></td></tr></table></figure>
<p>def decode(self)函数是专用于解密的函数，将字典编号以二进制形式存储在密文开头，解密时先以十进制形式的编号匹配相应字典，然后再用相应字典解密。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">def decode(self): </div><div class="line">    text = self.encoding.<span class="built_in">get</span>(<span class="string">'0.0'</span>, END).strip(<span class="string">'\n'</span>) </div><div class="line">    <span class="keyword">if</span> text.startswith(bin(<span class="keyword">int</span>(self.<span class="built_in">count</span>))[<span class="number">2</span>:]):   # 判断密文是否以二进制形式的加密所使用的密码字典的编号开头</div><div class="line">        text = text[<span class="built_in">len</span>(bin(<span class="keyword">int</span>(self.<span class="built_in">count</span>))[<span class="number">2</span>:]):]   # 编号匹配成功后，选择相应字典，跳过编号进行解密</div><div class="line">    <span class="keyword">global</span> de_fr </div><div class="line">de_fr = <span class="keyword">open</span>(<span class="comment">"/Users/zhangchuyue/Desktop/B15040805张楚月_哈夫曼加解密工具/password     </span></div><div class="line">       <span class="string">"dictionary/dictionary"</span> + self.<span class="built_in">count</span> + <span class="string">'.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>, errors=<span class="string">'ignore'</span>) </div><div class="line">    <span class="keyword">new</span> = Decode(de_fr) </div><div class="line">    nodeList = <span class="keyword">new</span>.getNodes() </div><div class="line">    tree = HuffumanTree(nodeList) </div><div class="line">    encoder = Encoding(tree.encodingList) </div><div class="line">    <span class="keyword">try</span>: </div><div class="line">        <span class="built_in">string</span> = encoder.getStringDecoding(str(text)) </div><div class="line">    excep<span class="variable">t:</span> </div><div class="line">        tkinter.messagebox.showerror(<span class="string">'错误'</span>, <span class="string">'无法解码，请重新输入!'</span>) </div><div class="line">        <span class="keyword">return</span> </div><div class="line">    self.<span class="built_in">string</span>[<span class="string">'state'</span>] = <span class="string">'normal'</span> </div><div class="line">    self.<span class="built_in">string</span>.<span class="keyword">delete</span>(<span class="string">'0.0'</span>, END) </div><div class="line">    self.<span class="built_in">string</span>.<span class="keyword">insert</span>(<span class="string">'0.0'</span>, <span class="built_in">string</span>) </div><div class="line">self.__reset.focus_set()</div></pre></td></tr></table></figure>
<h3 id="4-2-HuffmanTree-py模块核心代码"><a href="#4-2-HuffmanTree-py模块核心代码" class="headerlink" title="4.2 HuffmanTree.py模块核心代码"></a>4.2 HuffmanTree.py模块核心代码</h3><p>def __createTree(self,nodeList)函数的功能是使用给定的节点列表nodeList创建哈夫<br>曼树，返回根节点。</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">def __createTree(self, nodeList): </div><div class="line">    nodeList.<span class="built_in">sort</span>(<span class="built_in">key</span> = <span class="built_in">compare</span>) </div><div class="line">    lchild = nodeList[<span class="number">0</span>] </div><div class="line">    nodeList.<span class="built_in">remove</span>(lchild) </div><div class="line">    rchild = nodeList[<span class="number">0</span>] </div><div class="line">    nodeList.<span class="built_in">remove</span>(rchild) </div><div class="line">    parent = TreeNode(lchild = lchild, rchild = rchild, </div><div class="line">                    weight = lchild.weight + rchild.weight) </div><div class="line">    <span class="keyword">if</span> len(nodeList) == <span class="number">0</span>: </div><div class="line">         <span class="built_in">return</span> parent </div><div class="line">    <span class="keyword">else</span>: </div><div class="line">        nodeList.<span class="built_in">append</span>(parent) </div><div class="line">        <span class="built_in">return</span> self.__createTree(nodeList)</div></pre></td></tr></table></figure>
<p>def __display(self,root,level = ‘’)使用缩进格式在文件中输出哈夫曼树，以tree.txt的形式保存在目录中。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> __display<span class="params">(<span class="keyword">self</span>, root, level = <span class="string">''</span>)</span></span>: </div><div class="line">    <span class="keyword">if</span> level == <span class="string">''</span>: </div><div class="line">         <span class="keyword">self</span>.fw.write(level + repr(root) + <span class="string">'\n'</span>) </div><div class="line">    <span class="symbol">else:</span> </div><div class="line">        <span class="keyword">if</span> level[-<span class="number">4</span>] == <span class="string">' '</span>: </div><div class="line">            <span class="keyword">self</span>.fw.write(level[<span class="symbol">:-</span><span class="number">4</span>] + <span class="string">'└───'</span> + repr(root) + <span class="string">'\n'</span>) </div><div class="line">        <span class="symbol">else:</span> </div><div class="line">            <span class="keyword">self</span>.fw.write(level[<span class="symbol">:-</span><span class="number">3</span>] + <span class="string">'───'</span> + repr(root) + <span class="string">'\n'</span>) </div><div class="line"></div><div class="line">    <span class="keyword">if</span> root.lchild == <span class="symbol">None:</span> </div><div class="line">        <span class="keyword">return</span> </div><div class="line">    <span class="keyword">self</span>.__display(root. lchild, level + <span class="string">'│   '</span>) </div><div class="line"><span class="keyword">self</span>.__display(root. rchild, level + <span class="string">'    '</span>)</div></pre></td></tr></table></figure>
<p>HuffmanTree.py模块中，Encoding类中的方法是比较关键的，它们涉及到文件的加密和解密，最根本的加解密过程都是通过这个类里的加密方法def getStringEncoding(self, string)和解密方法def getStringDecoding(self, encoding)完成的。加密的大致过程是：初始化一个解密字符串encoding，然后用encodingList即单词和编码的字典中的单词一一匹配明文开头单词，如果匹配上了，将密文加入encoding，然后明文从下一个单词开头重复上一个步骤的匹配工作，以此类推，直到全部加密完成。解密步骤反之同理。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Encoding</span>: </span></div><div class="line">    <span class="function"><span class="keyword">def</span> __init__<span class="params">(<span class="keyword">self</span>, encodingList)</span></span>: </div><div class="line">        <span class="keyword">self</span>.encodingList = encodingList </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getStringEncoding</span><span class="params">(<span class="keyword">self</span>, string)</span></span>: </div><div class="line">        encoding = <span class="string">''</span> </div><div class="line">        <span class="keyword">while</span> string != <span class="string">''</span>: </div><div class="line">            flag = <span class="number">0</span> </div><div class="line">            <span class="keyword">for</span> (k, v) <span class="keyword">in</span> <span class="keyword">self</span>.encodingList.items(): </div><div class="line">                <span class="keyword">if</span> string.startswith(k) <span class="keyword">and</span> string[len(k)] == <span class="string">' '</span>:  <span class="comment">#判断明文字符串是否以字典中存在的单词开头</span></div><div class="line">                    encoding += v     <span class="comment"># 如果成功匹配到单词，encoding密文字符串加入相应的单词编码</span></div><div class="line">                    string = string[len(k) + <span class="number">1</span><span class="symbol">:</span>]    <span class="comment">#明文字符串跳过单词之间的空格，从下一个单词继续加密</span></div><div class="line">                    flag = <span class="number">1</span> </div><div class="line">                    <span class="keyword">break</span> </div><div class="line">            <span class="keyword">if</span> flag == <span class="number">0</span>: </div><div class="line">                    raise  Exception </div><div class="line">        <span class="keyword">return</span> encoding </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getStringDecoding</span><span class="params">(<span class="keyword">self</span>, encoding)</span></span>: </div><div class="line">        string = <span class="string">''</span> </div><div class="line">        <span class="keyword">while</span> encoding != <span class="string">''</span>: </div><div class="line">            flag = <span class="number">0</span> </div><div class="line">            <span class="keyword">for</span> (k, v) <span class="keyword">in</span>  <span class="keyword">self</span>.encodingList.items(): </div><div class="line">                <span class="keyword">if</span> encoding.startswith(v):   <span class="comment">#判断密文字符串是否以字典中存在的密文编码开头</span></div><div class="line">                    string += k </div><div class="line">                    string += <span class="string">' '</span> </div><div class="line">                    encoding = encoding[len(v)<span class="symbol">:</span>]   <span class="comment">#密文字符串继续从下一个单词编码解密</span></div><div class="line">                    flag = <span class="number">1</span> </div><div class="line">                    <span class="keyword">break</span> </div><div class="line">            <span class="keyword">if</span> flag == <span class="number">0</span>: </div><div class="line">                raise Exception </div><div class="line">        <span class="keyword">return</span> string</div></pre></td></tr></table></figure>
<h3 id="4-3-NodeDataIO-py模块核心代码"><a href="#4-3-NodeDataIO-py模块核心代码" class="headerlink" title="4.3 NodeDataIO.py模块核心代码"></a>4.3 NodeDataIO.py模块核心代码</h3><p>NodeDataIO类中最重要的就是初始化方法，它的功能是从password dictionary文件夹中随机选择一个加密字典，进行加密工作。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> __init__<span class="params">(<span class="keyword">self</span>)</span></span>: </div><div class="line">    root = <span class="string">"/Users/zhangchuyue/Desktop/B15040805张楚月_哈夫曼加解密工具/password dictionary"</span> </div><div class="line">    file_names = [] </div><div class="line">    <span class="keyword">for</span> parent, catalog, filename <span class="keyword">in</span> os.walk(root): </div><div class="line">        file_names = filename </div><div class="line">    file_names.remove(<span class="string">'.DS_Store'</span>) </div><div class="line">    x = random.randint(<span class="number">0</span>, len(file_names) - <span class="number">1</span>) </div><div class="line">    <span class="keyword">self</span>.fileName1 = file_names[x] </div><div class="line">    print(<span class="string">"choose a password dictionary: "</span> + <span class="keyword">self</span>.fileName1) </div><div class="line"><span class="keyword">self</span>.fr = open(<span class="string">"/Users/zhangchuyue/Desktop/B15040805张楚月_哈夫曼加解密工具/password  </span></div><div class="line"><span class="string">       "</span>dictionary/<span class="string">"  + self.fileName1, 'r', encoding='utf-8', errors='ignore')</span></div></pre></td></tr></table></figure>
<h3 id="4-4-decode-py模块核心代码"><a href="#4-4-decode-py模块核心代码" class="headerlink" title="4.4 decode.py模块核心代码"></a>4.4 decode.py模块核心代码</h3><p>与NodeDataIO类功能类似，除了初始化代码以外都相同。不过NodeDataIO负责加密，Decode类负责解密，解密根据字典编码选择相应字典，实现代码为Decode类的初始化方法。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> __init__<span class="params">(<span class="keyword">self</span>, fr)</span></span>: </div><div class="line"><span class="keyword">self</span>.fr = fr</div></pre></td></tr></table></figure>
<p>通过在Dialog.pyw MyDialog类中的def decode(self)方法中调用获得随机字典的文件名：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">de_fr = <span class="keyword">open</span>(<span class="comment">"/Users/zhangchuyue/Desktop/B15040805张楚月_哈夫曼加解密工具/password     </span></div><div class="line">        <span class="string">"dictionary/dictionary"</span> + self.<span class="built_in">count</span> + <span class="string">'.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>, errors=<span class="string">'ignore'</span>) </div><div class="line"><span class="keyword">new</span> = Decode(de_fr)</div></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="5-测试数据及其结果分析"><a href="#5-测试数据及其结果分析" class="headerlink" title="5.测试数据及其结果分析"></a>5.测试数据及其结果分析</h2><h3 id="5-1-合法数据输入-理想-amp-实际输出示例"><a href="#5-1-合法数据输入-理想-amp-实际输出示例" class="headerlink" title="5.1 合法数据输入-理想&amp;实际输出示例"></a>5.1 合法数据输入-理想&amp;实际输出示例<br></h3><p>输入：<br>my name is xliii he is my professor<br>输出：11110101111011011010110001001111011101001110001010010111000100111111011101001101101101010100110011<br>（choose a password dictionary: dictionary983.txt，此示例随机选择了dictionary983.txt进行加密）<br><img src="https://s2.ax1x.com/2019/11/15/MawNQg.png" alt="image"><br></p>
<h3 id="5-2-合法数据输入-错误输出示例"><a href="#5-2-合法数据输入-错误输出示例" class="headerlink" title="5.2 合法数据输入-错误输出示例"></a>5.2 合法数据输入-错误输出示例</h3><p>输入：<br>who is he<br>点击：<br>将加密结果导出到文件<br>现象：<br>未产生加密结果，进行except异常处理，弹出警告弹窗——没有可写字符<br><img src="https://s2.ax1x.com/2019/11/15/MawtSS.png" alt="image"><br></p>
<h3 id="5-3-非法数据输入-错误输出示例"><a href="#5-3-非法数据输入-错误输出示例" class="headerlink" title="5.3 非法数据输入-错误输出示例"></a>5.3 非法数据输入-错误输出示例</h3><p>输入：<br>dfwe fdd qewrqr<br>（输入为单词字典中不存在的单词）<br>输出：<br>进行except异常处理，弹出错误弹窗——您输入的文本中包含未编码的字符，请重新输入！<br><img src="https://s2.ax1x.com/2019/11/15/MawJW8.png" alt="image"><br><br></p>
<h2 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h2><p>python自带的tkinter库比较好用，但是实现的gui真的很丑。wxpython也应为各种坑装不了，大概是因为wxpython只能应用于32位的python……两周忙忙碌碌总算是做出来了，有时候码到深夜，饿到昏厥，不过结果还是挺好的，继续加油！</p>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2018/01/16/南邮小程序交互-视觉设计/" style="float: left;">
        ← 南邮小程序交互&视觉设计
    </a>
    
    
    <a class="pull-right" href="/2017/10/16/用python实现的猜数字小游戏/">
        用python实现的猜数字小游戏 →
    </a>
    
</nav>

        <div class="duoshuo">
<div id="disqus_thread"></div>
<script type="text/javascript">
	var disqus_shortname = 'triciatsuki';
	window.addEventListener('load', function(){
		(function(){
			var dsq = document.createElement('script');
			dsq.type = 'text/javascript';
			dsq.async = true;
			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		}());
	});
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2017<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Tricia. All Rights Reserved.
                </p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/tricia0127" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/919970127" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      (function(){
        console.log('font');
        var getCss = function(path) {
          var head = document.getElementsByTagName('head')[0];
          link = document.createElement('link');
          link.href = path;
          link.rel = 'stylesheet';
          link.type = 'text/css';
          head.appendChild(link);
        };
        getCss('https://fonts.googleapis.com/css?family=Montserrat:400,700');
        getCss('https://fonts.googleapis.com/css?family=Open+Sans:400,600');
      })();
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
